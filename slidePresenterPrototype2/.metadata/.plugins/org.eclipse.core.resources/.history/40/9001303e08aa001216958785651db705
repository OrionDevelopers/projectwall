var PEN_SIZE = 1;
var PEN_COLOR = 'black';

var containerReference, containerHeight, containerWidth, stage, slideLayer, drawingLayer;
var isPenToolSelected = true, isRectToolSelected = false, isfilledRectToolSelected = false, isHighlightToolSelected = false;
var toDraw = false;

function init() {//initialisation
	containerReference = document.getElementById("container");
	containerHeight = containerReference.offsetHeight;
	containerWidth = containerReference.offsetWidth;
	stage = new Kinetic.Stage({
		container : 'container',
		height : containerHeight,
		width : containerWidth
	});
	slideLayer = new Kinetic.Layer();
	drawingLayer = new Kinetic.Layer();
	drawingLayer.on('click', drawingLayerClicked);
	drawingLayer.on('mousedown', mouseDownOnSheet);
	drawingLayer.on('mouseup', mouseUpOnSheet);
	drawingLayer.on('mousemove', mouseMoveOnSheet);
	stage.add(slideLayer);
	stage.add(drawingLayer);
	setBackgroundSlide();
	setDrawingSheet('transparent');
}

function setBackgroundSlide() {
	var imgObj = new Image();
	imgObj.src = 'sampleSlide.PNG';
	var slideImg = new Kinetic.Image({
		x : 0,
		y : 0,
		height : containerHeight,
		width : containerWidth,
		image : imgObj
	});
	slideLayer.add(slideImg);
	slideLayer.draw();
	//var ctx = stage.getContext('2d');
	//slideLayer.draw();
}

function setDrawingSheet(fillStyle) {
	var sheet = new Kinetic.Rect({
		x : 0,
		y : 0,
		height : containerHeight,
		width : containerWidth,
		//fill:'red'
		fill : 'transparent'
	});
	//ctx = drawingLayer.getContext();
	drawingLayer.add(sheet);
	drawingLayer.draw();
	//ctx.clearRect(20,30,400,500);
	//drawingLayer.draw();

}

function mouseUpOnSheet(evt) {
	toDraw = false;
}

function mouseDownOnSheet(evt) {
	toDraw = true;
}

function mouseMoveOnSheet(evt) {
	if (toDraw == true) {
		if (isPenToolSelected) {
			var circle = new Kinetic.Circle({
				x : evt.offsetX,
				y : evt.offsetY,
				radius : PEN_SIZE,
				fill : PEN_COLOR
			});
			drawingLayer.add(circle);
			drawingLayer.draw();
		}
	} 
	else {
		return;
	}

}

function drawingLayerClicked() {
	//window.alert("hello there");
}

function dragOnDrawingLayer(evt) {
	console.log("asdf");
	if (isPenToolSelected) {
		var circle = new Kinetic.Circle({
			x : evt.offsetX,
			y : evt.offsetY,
			radius : PEN_SIZE,
			fill : PEN_COLOR
		});
		drawingLayer.add(circle);
		drawingLayer.draw();
	}
}
